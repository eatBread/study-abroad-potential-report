<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>留学潜力报告生成系统</title>
    <link rel="stylesheet" href="styles/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- 添加xlsx库 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <div class="header-text">
                    <h1>留学潜力报告生成系统</h1>
                    <p>基于科学评估的个性化留学规划报告</p>
                </div>
                <div class="header-actions">
                    <a href="test-global-logos.html" target="_blank" class="btn btn-secondary">
                        <span class="btn-icon">🏛️</span>
                        查看校徽列表
                    </a>
                </div>
            </div>
        </header>

        <nav class="nav-tabs">
            <button class="tab-btn" onclick="window.location.href='home.html'">🏠 首页</button>
            <button class="tab-btn" onclick="window.location.href='survey.html'">📋 在线问卷</button>
            <button class="tab-btn active" onclick="showTab('excel')">📊 Excel导入</button>
            <button class="tab-btn" onclick="showTab('input')">✏️ 学生信息录入</button>
            <button class="tab-btn" onclick="showTab('admin')">⚙️ 后台管理</button>
        </nav>

        <!-- Excel导入页面 -->
        <div id="excel-tab" class="tab-content active">
            <div class="form-container">
                <h2>Excel文件导入</h2>
                <div class="upload-section">
                    <div class="upload-area">
                        <input type="file" id="xlsxFile" accept=".xlsx,.xls" style="display: none;" />
                        <div class="upload-box" onclick="document.getElementById('xlsxFile').click()">
                            <div class="upload-icon">📁</div>
                            <div class="upload-text">
                                <p>点击选择Excel文件</p>
                                <p class="upload-hint">支持 .xlsx 和 .xls 格式</p>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="processXlsxFile()" id="processBtn" disabled>处理Excel文件</button>
                    </div>
                    
                    <div class="file-info" id="fileInfo" style="display: none;">
                        <h3>文件信息</h3>
                        <div id="fileDetails"></div>
                    </div>
                </div>

                <div class="data-preview" id="dataPreview" style="display: none;">
                    <h3>数据预览</h3>
                    <div class="preview-controls">
                        <button class="btn btn-secondary" onclick="exportToJson()">导出为JSON</button>
                        <button class="btn btn-primary" onclick="generateReportsFromExcel()">生成所有报告</button>
                        <button class="btn btn-secondary" onclick="viewAllReports()" id="viewReportsBtn" style="display: none;">查看所有报告</button>
                        <button class="btn btn-primary" onclick="fillStudentFormFromExcel(0)" id="fillFormBtn" style="display: none;">填入学生信息表单</button>
                    </div>
                    <div class="table-container">
                        <table id="previewTable" class="data-table">
                            <thead>
                                <tr id="tableHeader"></tr>
                            </thead>
                            <tbody id="tableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- 学生信息录入页面 -->
        <div id="input-tab" class="tab-content">
            <div class="form-container">
                <h2>学生基本信息</h2>
                <form id="student-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="studentName">学生姓名 *</label>
                            <input type="text" id="studentName" name="studentName" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="gender">性别 *</label>
                            <select id="gender" name="gender" required>
                                <option value="">请选择</option>
                                <option value="男">男</option>
                                <option value="女">女</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="grade">所在年级 *</label>
                            <select id="grade" name="grade" required>
                                <option value="">请选择</option>
                                <option value="高一">高一</option>
                                <option value="高二">高二</option>
                                <option value="高三">高三</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="school">所在学校名称 *</label>
                            <input type="text" id="school" name="school" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="subjectGroup">高考学科分组 *</label>
                            <select id="subjectGroup" name="subjectGroup" required>
                                <option value="">请选择</option>
                                <option value="物理组">物理组</option>
                                <option value="历史组">历史组</option>
                            </select>
                        </div>
                    </div>

                    <h3>学业成绩</h3>
                    <div class="scores-section">
                        <h4>最近一次考试成绩</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="currentChinese">语文</label>
                                <input type="number" id="currentChinese" name="currentChinese" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="currentMath">数学</label>
                                <input type="number" id="currentMath" name="currentMath" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="currentEnglish">英语</label>
                                <input type="number" id="currentEnglish" name="currentEnglish" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="currentPhysics">物理</label>
                                <input type="number" id="currentPhysics" name="currentPhysics" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="currentBiology">生物</label>
                                <input type="number" id="currentBiology" name="currentBiology" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="currentChemistry">化学</label>
                                <input type="number" id="currentChemistry" name="currentChemistry" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="currentHistory">历史</label>
                                <input type="number" id="currentHistory" name="currentHistory" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="currentPolitics">政治</label>
                                <input type="number" id="currentPolitics" name="currentPolitics" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="currentGeography">地理</label>
                                <input type="number" id="currentGeography" name="currentGeography" min="0" max="100">
                            </div>                     
                            <div class="form-group">
                                <label for="currentTotal">总分</label>
                                <input type="number" id="currentTotal" name="currentTotal" min="0" max="750">
                            </div>
                        </div>

                        <h4>预测高考成绩</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="predictedChinese">语文</label>
                                <input type="number" id="predictedChinese" name="predictedChinese" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="predictedMath">数学</label>
                                <input type="number" id="predictedMath" name="predictedMath" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="predictedEnglish">英语</label>
                                <input type="number" id="predictedEnglish" name="predictedEnglish" min="0" max="150">
                            </div>
                            <div class="form-group">
                                <label for="predictedPhysics">物理</label>
                                <input type="number" id="predictedPhysics" name="predictedPhysics" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedBiology">生物</label>
                                <input type="number" id="predictedBiology" name="predictedBiology" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedChemistry">化学</label>
                                <input type="number" id="predictedChemistry" name="predictedChemistry" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedHistory">历史</label>
                                <input type="number" id="predictedHistory" name="predictedHistory" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedPolitics">政治</label>
                                <input type="number" id="predictedPolitics" name="predictedPolitics" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedGeography">地理</label>
                                <input type="number" id="predictedGeography" name="predictedGeography" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label for="predictedTotal">总分</label>
                                <input type="number" id="predictedTotal" name="predictedTotal" min="0" max="750">
                            </div>
                        </div>
                    </div>

                    <h3>学业水平考试</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="academicLevelPass">是否通过学业水平考试</label>
                            <select id="academicLevelPass" name="academicLevelPass">
                                <option value="">请选择</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="academicSubject1">科目1(科目)</label>
                            <input type="text" id="academicSubject1" name="academicSubject1" placeholder="请输入科目名称">
                        </div>
                        <div class="form-group">
                            <label for="academicScore1">科目1(分数)</label>
                            <input type="number" id="academicScore1" name="academicScore1" min="0" max="100" placeholder="请输入分数">
                        </div>
                        <div class="form-group">
                            <label for="academicSubject2">科目2(科目)</label>
                            <input type="text" id="academicSubject2" name="academicSubject2" placeholder="请输入科目名称">
                        </div>
                        <div class="form-group">
                            <label for="academicScore2">科目2(分数)</label>
                            <input type="number" id="academicScore2" name="academicScore2" min="0" max="100" placeholder="请输入分数">
                        </div>
                        <div class="form-group">
                            <label for="academicSubject3">科目3(科目)</label>
                            <input type="text" id="academicSubject3" name="academicSubject3" placeholder="请输入科目名称">
                        </div>
                        <div class="form-group">
                            <label for="academicScore3">科目3(分数)</label>
                            <input type="number" id="academicScore3" name="academicScore3" min="0" max="100" placeholder="请输入分数">
                        </div>
                    </div>

                    <h3>补习情况</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="hasTutoring">是否进行学科补习</label>
                            <select id="hasTutoring" name="hasTutoring">
                                <option value="">请选择</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tutoringSubjects">正在补习的科目</label>
                            <input type="text" id="tutoringSubjects" name="tutoringSubjects" placeholder="多个科目请用逗号分隔">
                        </div>
                    </div>

                    <h3>专业倾向与留学意向</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label>大学倾向专业方向</label>
                            <div class="checkbox-group" id="majorPreferenceGroup">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_building" name="majorPreference" value="建筑">
                                    <label for="major_building">建筑</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_science" name="majorPreference" value="理科">
                                    <label for="major_science">理科</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_engineering" name="majorPreference" value="工科">
                                    <label for="major_engineering">工科</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_business" name="majorPreference" value="商科">
                                    <label for="major_business">商科</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_liberal" name="majorPreference" value="文科">
                                    <label for="major_liberal">文科</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_medical" name="majorPreference" value="医护">
                                    <label for="major_medical">医护</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_music" name="majorPreference" value="音乐">
                                    <label for="major_music">音乐</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_art" name="majorPreference" value="美术">
                                    <label for="major_art">美术</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="major_other" name="majorPreference" value="其他">
                                    <label for="major_other">其他</label>
                                </div>
                            </div>
                        </div>
                        
                    </div>

                    <h3>国际英语成绩</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="englishTestType">国际英语成绩类型</label>
                            <select id="englishTestType" name="englishTestType">
                                <option value="">请选择</option>
                                <option value="雅思">雅思</option>
                                <option value="托福">托福</option>
                                <option value="PTE">PTE</option>
                                <option value="多邻国">多邻国</option>
                                <option value="暂无">暂无</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="englishTotalScore">总分</label>
                            <input type="text" id="englishTotalScore" name="englishTotalScore" placeholder="请输入总分">
                        </div>
                        
                        <div class="form-group">
                            <label for="englishListening">听力</label>
                            <input type="text" id="englishListening" name="englishListening" placeholder="请输入听力成绩">
                        </div>
                        
                        <div class="form-group">
                            <label for="englishReading">阅读</label>
                            <input type="text" id="englishReading" name="englishReading" placeholder="请输入阅读成绩">
                        </div>
                        
                        <div class="form-group">
                            <label for="englishSpeaking">口语</label>
                            <input type="text" id="englishSpeaking" name="englishSpeaking" placeholder="请输入口语成绩">
                        </div>
                        
                        <div class="form-group">
                            <label for="englishWriting">写作</label>
                            <input type="text" id="englishWriting" name="englishWriting" placeholder="请输入写作成绩">
                        </div>
                    </div>

                    <h3>留学意向</h3>
                    <div class="form-grid">
                        
                        <div class="form-group">
                            <label>留学意向国家/地区</label>
                            <div class="checkbox-group" id="studyDestinationGroup">
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_usa" name="studyDestination" value="美国">
                                    <label for="destination_usa">🇺🇸 美国</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_uk" name="studyDestination" value="英国">
                                    <label for="destination_uk">🇬🇧 英国</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_australia" name="studyDestination" value="澳大利亚">
                                    <label for="destination_australia">🇦🇺 澳大利亚</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_hongkong" name="studyDestination" value="中国香港">
                                    <label for="destination_hongkong">🇭🇰 中国香港</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_macao" name="studyDestination" value="中国澳门">
                                    <label for="destination_macao">🇲🇴 中国澳门</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_singapore" name="studyDestination" value="新加坡">
                                    <label for="destination_singapore">🇸🇬 新加坡</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_malaysia" name="studyDestination" value="马来西亚">
                                    <label for="destination_malaysia">🇲🇾 马来西亚</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_canada" name="studyDestination" value="加拿大">
                                    <label for="destination_canada">🇨🇦 加拿大</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_netherlands" name="studyDestination" value="荷兰">
                                    <label for="destination_netherlands">🇳🇱 荷兰</label>
                                </div>
                                <div class="checkbox-item">
                                    <input type="checkbox" id="destination_newzealand" name="studyDestination" value="新西兰">
                                    <label for="destination_newzealand">🇳🇿 新西兰</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="budget">预期留学投入费用</label>
                            <select id="budget" name="budget">
                                <option value="">请选择</option>
                                <option value="80万以内">80万以内</option>
                                <option value="100万以内">100万以内</option>
                                <option value="120万以内">120万以内</option>
                                <option value="150万以内">150万以内</option>
                                <option value="200万以内">200万以内</option>
                                <option value="200万以上">200万以上</option>
                            </select>
                        </div>
                    </div>

                    <h3>课外活动与个人素养</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="hasClub">是否参加学校社团</label>
                            <select id="hasClub" name="hasClub">
                                <option value="">请选择</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="clubActivities">参加的社团</label>
                            <input type="text" id="clubActivities" name="clubActivities" placeholder="多个社团请用逗号分隔">
                        </div>
                        
                        <div class="form-group">
                            <label for="hasLongTermHobby">是否有维持3年以上的兴趣爱好</label>
                            <select id="hasLongTermHobby" name="hasLongTermHobby">
                                <option value="">请选择</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="hobbies">兴趣爱好</label>
                            <input type="text" id="hobbies" name="hobbies" placeholder="多个爱好请用逗号分隔">
                        </div>
                        
                        <div class="form-group">
                            <label for="friendsCount">经常来往的好友数量</label>
                            <select id="friendsCount" name="friendsCount">
                                <option value="">请选择</option>
                                <option value="没有">没有</option>
                                <option value="1-3个">1-3个</option>
                                <option value="3-5个">3-5个</option>
                                <option value="5个以上">5个以上</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="talents">持续学习3年以上的才艺</label>
                            <input type="text" id="talents" name="talents" placeholder="多个才艺请用┋分隔，如：音乐┋舞蹈┋体育">
                        </div>
                        
                        <div class="form-group">
                            <label for="certificates">才艺证书资质或奖项</label>
                            <input type="text" id="certificates" name="certificates" placeholder="多个证书请用逗号分隔">
                        </div>
                        
                        <div class="form-group">
                            <label for="organizationFrequency">整理生活和工作空间频率</label>
                            <select id="organizationFrequency" name="organizationFrequency">
                                <option value="">请选择</option>
                                <option value="每天至少一次">每天至少一次</option>
                                <option value="每周至少一次">每周至少一次</option>
                                <option value="每月至少一次">每月至少一次</option>
                                <option value="半年至少一次">半年至少一次</option>
                                <option value="从不整理">从不整理</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="askForHelp">遇到困难是否向周围的人求助</label>
                            <input type="text" id="askForHelp" name="askForHelp" placeholder="请填写学生的应对方式">
                        </div>
                        
                        <div class="form-group">
                            <label for="studyPersistence">学习中遇到阻碍时的坚持程度</label>
                            <input type="text" id="studyPersistence" name="studyPersistence" placeholder="请填写学生的坚持程度">
                        </div>
                        
                        <div class="form-group">
                            <label for="internationalExperience">国外生活经历时长</label>
                            <select id="internationalExperience" name="internationalExperience">
                                <option value="">请选择</option>
                                <option value="从来没有">从来没有</option>
                                <option value="一个月以内">一个月以内</option>
                                <option value="6个月以内">6个月以内</option>
                                <option value="一年以内">一年以内</option>
                                <option value="一年以上">一年以上</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="campExperience">是否参加过夏令营/冬令营</label>
                            <select id="campExperience" name="campExperience">
                                <option value="">请选择</option>
                                <option value="是">是</option>
                                <option value="否">否</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="canCook">做饭水平</label>
                            <input type="text" id="canCook" name="canCook" placeholder="请填写学生的做饭水平描述">
                        </div>
                        
                        <div class="form-group">
                            <label for="readingTime">每天课外阅读时间（小时）</label>
                            <input type="number" id="readingTime" name="readingTime" min="0" max="8" step="0.5" placeholder="请输入0-8的数字，支持0.5">
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">生成报告</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- 后台管理页面 -->
        <div id="admin-tab" class="tab-content">
            <div class="admin-container">
                <h2>后台管理设置</h2>
                
                <!-- 状态提示区域 -->
                <div class="status-banner" id="admin-status">
                    <div class="status-info">
                        <span class="status-icon">ℹ️</span>
                        <span class="status-text" id="status-text">在这里可以自定义报告的所有内容。配置完成后可以直接生成报告预览。</span>
                    </div>
                    <button type="button" class="btn btn-primary btn-small" onclick="generateReportFromAdmin()">📊 生成报告</button>
                </div>
                
                <div class="admin-section">
                    <h3>雷达图维度设置</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="academicAbility">学术能力 (0-100)</label>
                            <input type="number" id="academicAbility" name="academicAbility" min="0" max="100" value="75">
                        </div>
                        <div class="form-group">
                            <label for="languageAbility">语言能力 (0-100)</label>
                            <input type="number" id="languageAbility" name="languageAbility" min="0" max="100" value="70">
                        </div>
                        <div class="form-group">
                            <label for="artisticQuality">文体素养 (0-100)</label>
                            <input type="number" id="artisticQuality" name="artisticQuality" min="0" max="100" value="80">
                        </div>
                        <div class="form-group">
                            <label for="socialAbility">生活能力 (0-100)</label>
                            <input type="number" id="socialAbility" name="socialAbility" min="0" max="100" value="85">
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>四维能力详细分析</h3>
                    <p class="section-desc">为每个能力维度设置详细的分析内容。留空则根据分数自动生成对应评价。</p>
                    
                    <!-- 学术能力分析 -->
                    <div class="ability-analysis">
                        <h4>📚 学术能力分析</h4>
                        <div class="analysis-grid">
                            <div class="form-group">
                                <label for="academicStrengths">优势</label>
                                <textarea id="academicStrengths" name="academicStrengths" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="academicWeaknesses">不足</label>
                                <textarea id="academicWeaknesses" name="academicWeaknesses" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="academicSuggestions">可行性建议</label>
                                <textarea id="academicSuggestions" name="academicSuggestions" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 语言能力分析 -->
                    <div class="ability-analysis">
                        <h4>🌍 语言能力分析</h4>
                        <div class="analysis-grid">
                            <div class="form-group">
                                <label for="languageStrengths">优势</label>
                                <textarea id="languageStrengths" name="languageStrengths" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="languageWeaknesses">不足</label>
                                <textarea id="languageWeaknesses" name="languageWeaknesses" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="languageSuggestions">可行性建议</label>
                                <textarea id="languageSuggestions" name="languageSuggestions" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 文体素养分析 -->
                    <div class="ability-analysis">
                        <h4>🎨 文体素养分析</h4>
                        <div class="analysis-grid">
                            <div class="form-group">
                                <label for="artisticStrengths">优势</label>
                                <textarea id="artisticStrengths" name="artisticStrengths" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="artisticWeaknesses">不足</label>
                                <textarea id="artisticWeaknesses" name="artisticWeaknesses" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="artisticSuggestions">可行性建议</label>
                                <textarea id="artisticSuggestions" name="artisticSuggestions" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- 社交能力分析 -->
                    <div class="ability-analysis">
                        <h4>🏠 生活能力分析</h4>
                        <div class="analysis-grid">
                            <div class="form-group">
                                <label for="socialStrengths">优势</label>
                                <textarea id="socialStrengths" name="socialStrengths" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="socialWeaknesses">不足</label>
                                <textarea id="socialWeaknesses" name="socialWeaknesses" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="socialSuggestions">可行性建议</label>
                                <textarea id="socialSuggestions" name="socialSuggestions" rows="2" placeholder="留空则根据分数自动生成"></textarea>
                            </div>
                        </div>
                    </div>


                    <div class="admin-section">
                        <h3>综合提升建议</h3>
                        <div class="form-group">
                            <label for="overallSuggestions">整体建议</label>
                            <textarea id="overallSuggestions" name="overallSuggestions" rows="4" placeholder="留空则根据四维分析自动汇总生成">1. 加强英语听说读写能力，建议参加雅思或托福培训
2. 扩展学术课外活动，如科研项目或学科竞赛
3. 发展文体特长，参与相关比赛和活动
4. 培养独立生活技能，为留学做好准备</textarea>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>院校与专业推荐</h3>
                    
                    <h4>冲刺院校（2所）</h4>
                    <div class="university-grid">
                        <div class="university-item">
                            <div class="university-name-row">
                                <input type="text" placeholder="大学名称" id="reach1Name" value="剑桥大学">
                                <button type="button" class="select-university-btn" onclick="openUniversitySelector('reach1')">选择大学</button>
                            </div>
                            <input type="text" placeholder="英文名称" id="reach1EnglishName" value="University of Cambridge">
                            <select id="reach1MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="reach1Major" value="工程学">
                            <input type="text" placeholder="地区" id="reach1Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="reach1Logo" value="https://via.placeholder.com/60x60?text=剑桥">
                            <textarea placeholder="推荐理由" id="reach1Reason" rows="2">世界顶尖学府，工程专业排名全球前3，学术声誉卓越</textarea>
                        </div>
                        <div class="university-item">
                            <div class="university-name-row">
                            <input type="text" placeholder="大学名称" id="reach2Name" value="伦敦帝国学院">
                            <button type="button" class="select-university-btn" onclick="openUniversitySelector('reach2')">选择大学</button>
                        </div>
                            <input type="text" placeholder="英文名称" id="reach2EnglishName" value="Imperial College London">
                            <select id="reach2MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="reach2Major" value="计算机科学">
                            <input type="text" placeholder="地区" id="reach2Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="reach2Logo" value="https://via.placeholder.com/60x60?text=帝国">
                            <textarea placeholder="推荐理由" id="reach2Reason" rows="2">计算机科学全球领先，就业前景极佳，科研实力雄厚</textarea>
                        </div>
                    </div>

                    <h4>稳妥院校（2所）</h4>
                    <div class="university-grid">
                        <div class="university-item">
                            <div class="university-name-row">
                                <input type="text" placeholder="大学名称" id="match1Name" value="曼彻斯特大学">
                                <button type="button" class="select-university-btn" onclick="openUniversitySelector('match1')">选择大学</button>
                            </div>
                            <input type="text" placeholder="英文名称" id="match1EnglishName" value="The University of Manchester">
                            <select id="match1MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="match1Major" value="电子工程">
                            <input type="text" placeholder="地区" id="match1Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="match1Logo" value="https://via.placeholder.com/60x60?text=曼大">
                            <textarea placeholder="推荐理由" id="match1Reason" rows="2">电子工程专业实力强劲，工业界认可度高，就业稳定</textarea>
                        </div>
                        <div class="university-item">
                            <div class="university-name-row">
                                <input type="text" placeholder="大学名称" id="match2Name" value="伯明翰大学">
                                <button type="button" class="select-university-btn" onclick="openUniversitySelector('match2')">选择大学</button>
                            </div>
                            <input type="text" placeholder="英文名称" id="match2EnglishName" value="University of Birmingham">
                            <select id="match2MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="match2Major" value="机械工程">
                            <input type="text" placeholder="地区" id="match2Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="match2Logo" value="https://via.placeholder.com/60x60?text=伯明翰">
                            <textarea placeholder="推荐理由" id="match2Reason" rows="2">机械工程历史悠久，实践教学丰富，毕业生就业率高</textarea>
                        </div>
                    </div>

                    <h4>保底院校（2所）</h4>
                    <div class="university-grid">
                        <div class="university-item">
                            <div class="university-name-row">
                                <input type="text" placeholder="大学名称" id="safety1Name" value="利兹大学">
                                <button type="button" class="select-university-btn" onclick="openUniversitySelector('safety1')">选择大学</button>
                            </div>
                            <input type="text" placeholder="英文名称" id="safety1EnglishName" value="University of Leeds">
                            <select id="safety1MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="safety1Major" value="土木工程">
                            <input type="text" placeholder="地区" id="safety1Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="safety1Logo" value="https://via.placeholder.com/60x60?text=利兹">
                            <textarea placeholder="推荐理由" id="safety1Reason" rows="2">土木工程专业扎实，课程设置实用，性价比高</textarea>
                        </div>
                        <div class="university-item">
                            <div class="university-name-row">
                                <input type="text" placeholder="大学名称" id="safety2Name" value="谢菲尔德大学">
                                <button type="button" class="select-university-btn" onclick="openUniversitySelector('safety2')">选择大学</button>
                            </div>
                            <input type="text" placeholder="英文名称" id="safety2EnglishName" value="The University of Sheffield">
                            <select id="safety2MajorDirection">
                                <option value="建筑">建筑</option>
                                <option value="理科" selected>理科</option>
                                <option value="工科">工科</option>
                                <option value="商科">商科</option>
                                <option value="文科">文科</option>
                                <option value="医护">医护</option>
                                <option value="音乐">音乐</option>
                                <option value="美术">美术</option>
                                <option value="其他">其他</option>
                            </select>
                            <input type="text" placeholder="专业名称" id="safety2Major" value="材料科学">
                            <input type="text" placeholder="地区" id="safety2Location" value="英国">
                            <input type="url" placeholder="校徽URL" id="safety2Logo" value="https://via.placeholder.com/60x60?text=谢菲">
                            <textarea placeholder="推荐理由" id="safety2Reason" rows="2">材料科学领域知名，研究环境优良，申请门槛适中</textarea>
                        </div>
                    </div>
                </div>

                <div class="admin-section">
                    <h3>服务引流模块</h3>
                    <div class="form-group">
                        <label for="serviceTitle">主标题</label>
                        <input type="text" id="serviceTitle" name="serviceTitle" placeholder="请输入主标题..." value="高考成绩锁定海外名校！">
                    </div>
                    <div class="form-group">
                        <label for="serviceSubtitle">副标题</label>
                        <input type="text" id="serviceSubtitle" name="serviceSubtitle" placeholder="请输入副标题..." value="联系我们获取更多高考海外升学资讯及个性化解决方案">
                    </div>
                    <div class="form-group">
                        <label for="qrCodeImage">二维码图片</label>
                        <input type="url" id="qrCodeImage" name="qrCodeImage" placeholder="请输入二维码图片URL（留空使用默认图片）..." value="">
                        <small class="form-help">留空将使用默认二维码图片</small>
                    </div>
                    <div class="form-group">
                        <label for="contactEmail">联系邮箱</label>
                        <input type="email" id="contactEmail" name="contactEmail" placeholder="请输入联系邮箱..." value="maerzchen@live.com">
                    </div>
                    <div class="form-group">
                        <label for="techSupport">技术支持机构</label>
                        <input type="text" id="techSupport" name="techSupport" placeholder="请输入技术支持机构名称..." value="未名教育">
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="saveAdminSettings()">保存设置</button>
                    <button type="button" class="btn btn-primary" onclick="generateReportFromAdmin()">📊 生成报告</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 大学选择器模态框 -->
    <div id="universitySelectorModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>选择大学</h3>
                <span class="close" onclick="closeUniversitySelector()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="search-section">
                    <input type="text" id="universitySearch" placeholder="搜索大学名称..." onkeyup="filterUniversities()">
                    <div class="filter-buttons">
                        <button type="button" class="filter-btn active" onclick="filterByCountry('all')">全部</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('美国')">美国</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('英国')">英国</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('中国')">中国</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('澳大利亚')">澳大利亚</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('加拿大')">加拿大</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('德国')">德国</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('日本')">日本</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('韩国')">韩国</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('新加坡')">新加坡</button>
                        <button type="button" class="filter-btn" onclick="filterByCountry('其他')">其他</button>
                    </div>
                </div>
                <div class="universities-list" id="universitiesList">
                    <!-- 大学列表将在这里动态生成 -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeUniversitySelector()">取消</button>
            </div>
        </div>
    </div>

    <script src="scripts/university-data.js"></script>
    <script src="scripts/main.js"></script>
</body>
</html> 