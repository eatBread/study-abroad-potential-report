# Excel导入功能使用说明

## 功能概述
本系统支持通过Excel文件批量导入学生数据，并自动生成留学潜力报告。

## 支持的Excel格式
- 文件格式：`.xlsx` 或 `.xls`
- 第一行：必须包含列标题
- 第二行开始：学生数据

## 必需的列名
Excel文件必须包含以下列名（按顺序）：

1. `序号` - 学生序号
2. `提交答卷时间` - 提交时间
3. `所用时间` - 填写问卷所用时间
4. `来源` - 数据来源
5. `来源详情` - 来源详细信息
6. `来自IP` - IP地址
7. `总分` - 问卷总分
8. `1、学生姓名：` - 学生姓名
9. `2、学生性别：` - 性别（男/女）
10. `3、所在年级：` - 年级（高一/高二/高三）
11. `4、您所在的学校名称：` - 学校名称
12. `5、学生的学科分组是？` - 学科分组（物理组/历史组）

## 成绩相关列
### 当前成绩（第6题）- 对应表单字段
- `6、请填写最后一次联考或期末考试—语文` → currentChinese（语文）
- `6、数学` → currentMath（数学）
- `6、英语` → currentEnglish（英语）
- `6、物理` → currentPhysics（物理）
- `6、生物` → currentBiology（生物）
- `6、化学` → currentChemistry（化学）
- `6、历史` → currentHistory（历史）
- `6、政治` → currentPolitics（政治）
- `6、地理` → currentGeography（地理）
- 总分字段会自动计算前9项成绩的总和

### 预测成绩（第7题）- 对应表单字段
- `7、请填写预计的高考成绩—语文` → predictedChinese（语文）
- `7、数学` → predictedMath（数学）
- `7、英语` → predictedEnglish（英语）
- `7、物理` → predictedPhysics（物理）
- `7、生物` → predictedBiology（生物）
- `7、化学` → predictedChemistry（化学）
- `7、历史` → predictedHistory（历史）
- `7、政治` → predictedPolitics（政治）
- `7、地理` → predictedGeography（地理）
- 预测总分字段会自动计算前9项预测成绩的总和

## 其他信息列
- `8、是否通过学业水平考试`
- `9、请填写学业水平成绩—科目1`
- `9、科目2`
- `9、科目3`
- `10、是否有进行学科补习` → hasTutoring（是否进行学科补习）
- `11、请选择有补过或正在补习的科目` → tutoringSubjects（正在补习的科目）
- `12、请选择学生大学倾向就读的专业方向` → majorPreference（专业倾向，多选，用"┋"分隔）
- `13、请选择学生目前已有成绩的国际英语考试` → englishTestType（国际英语成绩类型）
- `14、请填写其中一项国际英语考试的成绩—总分` → englishTotalScore（总分）
- `14、听力` → englishListening（听力）
- `14、阅读` → englishReading（阅读）
- `14、口语` → englishSpeaking（口语）
- `14、写作` → englishWriting（写作）
- `15、请选择学生有留学意愿的国家或地区` → studyDestination（留学意向国家/地区，多选，用"┋"分隔）
- `16、预期留学投入费用（含学费和生活费）` → budget（预期留学投入费用）
- `17、学生是否有在学校参加社团？` → hasClub（是否参加学校社团）
- `18、请填写学生参加的社团` → clubActivities（参加的社团）
- `19、学生是否有一项持续3年以上的兴趣爱好？` → hasLongTermHobby（是否有维持3年以上的兴趣爱好）
- `20、请填写学生持续3年以上的兴趣或爱好` → hobbies（兴趣爱好）
- `21、除了同学，学生在外有多少个经常来往的朋友？` → friendsCount（经常来往的好友数量，文本格式）
- `22、学生是否有持续学习3年以上音乐、舞蹈、体育、艺术等各方面的才艺？` → talents（才艺，多选，用"┋"分隔，对应Excel第51列）
- `23、请填写学生有在才艺相关的领域获得的证书、资质或奖项？` → certificates（才艺证书资质或奖项，对应Excel第52列）
- `24、学生多久会整理一次自己的生活与工作空间？` → organizationFrequency（整理生活和工作空间频率，对应Excel第53列）
- `25、学生在遇到困难时，是否会主动向身边的人进行求助？` → askForHelp（遇到困难是否向周围的人求助，对应Excel第54列）
- `26、学生是否会自己做饭？` → canCook（是否会自己做饭，对应Excel第55列）
- `27、学生平均每天课外阅读的时间` → readingTime（每天课外阅读时间，对应Excel第56列）

## 使用步骤

1. **准备Excel文件**
   - 确保第一行包含所有必需的列名
   - 从第二行开始填写学生数据
   - 保存为`.xlsx`或`.xls`格式

2. **上传文件**
   - 打开系统，切换到"Excel导入"标签页
   - 点击上传区域选择Excel文件
   - 点击"处理Excel文件"按钮

3. **查看数据预览**
   - 系统会显示文件信息（总行数、总列数、带序号的列名列表）
   - 显示前5行数据的预览表格，每列上方显示列序号
   - 点击列序号可以复制到剪贴板，方便后续操作

4. **生成报告**
   - 点击"生成所有报告"按钮
   - 系统会为每个学生生成个性化报告
   - 显示生成结果（成功/失败数量）

5. **填充学生信息表单**
   - 点击"填入学生信息表单"按钮
   - 选择要填入表单的数据行
   - 系统会自动将Excel数据填入"学生信息录入"页面
   - 包括基本信息（姓名、性别、年级、学校、学科分组）
   - 包括当前成绩信息（9个科目的成绩，当前总分自动计算）
   - 包括预测成绩信息（9个科目的预测成绩，预测总分自动计算）
   - 包括补习情况信息（是否补习、补习科目）
   - 包括专业倾向信息（多选复选框，支持多个专业方向）
   - 包括国际英语成绩信息（成绩类型和详细分数）
   - 包括留学意向信息（多选复选框，支持多个国家/地区）
   - 可以切换到"学生信息录入"标签页查看填充结果
   - 手动修改任何成绩字段时，对应的总分会自动重新计算

6. **查看报告**
   - 点击"查看所有报告"按钮
   - 选择要查看的学生报告
   - 报告会在新窗口中打开

## 注意事项

1. **数据格式**：确保Excel文件格式正确，列名完全匹配
2. **数据完整性**：必填字段不能为空
3. **文件大小**：建议单个文件不超过1000行数据
4. **浏览器兼容性**：建议使用Chrome、Firefox、Safari等现代浏览器

## 故障排除

1. **文件无法上传**：检查文件格式是否为`.xlsx`或`.xls`
2. **处理失败**：检查Excel文件格式和列名是否正确
3. **数据预览异常**：检查Excel文件是否包含标题行
4. **报告生成失败**：检查学生数据是否完整

## 示例数据
可以参考`test_data.csv`文件中的示例数据格式。
